<!-- 날씨정보 가져오는 로직과 함수가 담긴 파일입니다. -->
<!DOCTYPE html>
<html>

<head>
    <title>weather api- 위치로 날씨정보 받아오는용</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>


    <script>
        function getLocation() {
            if (navigator.geolocation) {
                console.log('geolocation');
                navigator.geolocation.getCurrentPosition(locationSuccess, locationError);
            } else {
                console.log("지오 로케이션 없음")
            }
        };


        async function locationSuccess(p) {
            var latitude = p.coords.latitude, longitude = p.coords.longitude;
            console.log(latitude, longitude);

            // 사용자 위경도 전송
            await axios({
                method: 'post',
                url: "//localhost:8000/weather/getlocation",
                data: {
                    latitude: latitude,
                    longitude: longitude
                }
            }).then(function (response) {
                // 날씨정보 JSON파일로 받기 ( 팀노션 - API관리 참고 )
                // 한시간당 12항목 (numOfRows = 12) 받을 수 있습니다 
                // response.data 가공해서 쓰세요
                console.log('날씨정보 확인');
                console.log(response.data);
            });
        }

        function locationError(error) {
            var errorTypes = {
                0: "알 수 없는 에러",
                1: "허용 안눌렀음",
                2: "위치가 안잡힘",
                3: "응답시간 지남"
            };
            var errorMsg = errorTypes[error.code];
            console.log(errorMsg)
        }   // locationError



    </script>
</head>

<body>
    <button type="button" onclick="getLocation();">현재위치 가져오기</button>
</body>

</html>